---
title: UDS诊断规范笔记
date: 2022-01-26 17:56:10
tags:
- UDS
- 诊断
categories:
- 工作笔记
---



此笔记使用**LIN协议**

## 1.传输层PDU

### 1.1.LIN传输层支持的PDU格式

![](https://cdn.jsdelivr.net/gh/czc13611858691/picgoRepo/20220126175848.png)

### 1.2.PCI

![](https://cdn.jsdelivr.net/gh/czc13611858691/picgoRepo/20220126175957.png)

### 1.3.SID与RSID

- SID（Service Identifier）表示了从机节点应完成的服务请求。
- RSID（Response Service Identifier）表示从机节点应答的内容。如果是**肯定的响应**（Positive Response），首字节回复**[SID+0x40]**，举例子就是请求0x10，响应0x50；请求0x22，响应0x62。如果是**否定的响应**（Negative Response），首字节回复**0x7F**，第二字节回复刚才询问的SID。比如Tester请求0x10服务，我想进入编程模式，ECU给出否定响应，首字节0x7F，第二字节回复0x10，代表我否定你的0x10服务请求，第三字节是NRC(否定响应码)，代表我否定你的依据。

## 2.否定响应码NRC

### 2.1.举例

- 通用错误  0x10
- 服务SID不支持 0x11
- 服务的子服务不支持 0x12
- 数据长度错误  0x13
- 服务在当前会话下不支持 0x7F

## 3.会话模式

- 默认会话 01
- 编程会话 02
- 扩展会话 03

不同会话模式下支持的服务不同，DID不同

## 4.服务例子

### 4.1.诊断会话控制$10

上电默认会话模式0x01

数据第一个字节代表切换不同的会话模式

- 默认会话 01
- 编程会话 02
- 扩展会话 03

**肯定响应**

标识符+诊断会话类型

**否定响应**

错误码

12 子功能不支持

13 长度错误

22 长度不满足